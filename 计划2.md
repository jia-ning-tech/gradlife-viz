我先把“形势总览”说清楚，然后列出接下来要做的 checklist，方便我们一项项打钩。

---

## 0. 现在已经完成的部分（简要回顾）

**Python 端：**

* 原始 Excel 的清洗、题目类型识别、变量重编码 ✔
* 构建 high_stress_group（高工时 + 差 WLB）的衍生变量 ✔
* 生成各种分析用衍生表 & viz 用的 CSV：degree、debt、mental help、bullying、harassment、region、country、support、support_quadrant 等 ✔

**前端可视化：**

* 多个“单主题页面”都已经有了：

  * degree × high stress
  * debt × high stress
  * mental_help（整体 + 按学位） × high stress
  * satisfaction × high stress
  * satisfaction_change × high stress
  * bullying × high stress
  * harassment × high stress
  * region × high stress
  * country_rose_map × high stress
  * support × high stress
  * support_quadrant × high stress（带学位 + 地区过滤）
* 新的 index 页面已经完成，结构轻量、不闪屏，导航可以正常切换所有页面 ✔

换句话说：**“高压组是谁，以及与经济压力 / 满意度 / 支持 / 风险事件 / 地理差异”的主线，已经被 Python + JS 打通了。**

---

## 1. 按之前“大计划”还有哪些任务没做完？

我按照我们当初的大计划结构来对齐一下，哪些已经做了、哪些是“TODO”。

### A 线：现有专题的打磨 / 小补充

**A1. “风险事件 / 帮助”线统一风格**（部分完成，仍可微调）

* Bullying × high stress、Harassment × high stress、Mental-help × high stress，这几页已经有了，但如果以后写论文 / 做展示，可以考虑：

  * 统一标题、副标题的措辞（research question + high-stress 定义说明）。
  * 统一 tooltip 格式（都显示：组内高压比例 + n）。
  * 统一控制组件（比如百分比/计数、堆叠/分组开关的样式）。

👉 这类属于“打磨 + 统一视觉规范”，可随时做，不算硬性技术任务。

**A2. 支持四象限页** ✅ 已基本完成

* 我们已经做了：

  * Python 端：`46_support_quadrant_by_deg_region.py` 生成 degree × region × quadrant 的汇总表。
  * 前端：新的 `support_quadrant_high_stress.html`，带 degree + region 过滤，3×3 热力图 + 排名条图，色彩和标签问题也解决了。
* 这块可以视为 **已经完成主功能**，后续只要有需要再微调文案或色彩即可。

**A3. “满意度变化 × 高压”页** ✅ 已有页面（但可以确认 / 小调整）

* 从你的前端列表看，`satisfaction_change_high_stress.html` 已经在了；逻辑上大致对应当时说的 Q26。
* 后续如果觉得这页的信息还不够清晰，可以考虑：

  * 在页面顶部加一句 summary：例如“满意度下降组中，高压比例是 xx%，显著高于满意度上升/持平组”——这个需要在 Python 再算一张 summary 表导出给前端用。

---

### B 线：挖“背景变量 & 工作负荷”

这一块是我们**当初计划里还没有真正动手实现的**，如果你想继续深入，可以按下面几步来：

#### B1. “工作负荷解释页”（工时本身）【未做】

目的：
虽然高压定义里用到了工时，但我们还没有一页专门展示“工时分布 × 高压”。

**需要在 Python 端做的：**

* 从清洗后的主表中：

  * 取出 weekly_hours（或 hours_category）
  * 对比 high_stress_group = 1 / 0 的分布：

    * 工时分布直方图 / 条图；
    * 各工时档（≤40, 41–50, 51–60, >60）内部的高压比例。
* 导出：

  * 一个用于描述统计的 CSV（整体工时分布）。
  * 一个用于可视化的 CSV，比如：`viz_hours_vs_high_stress.csv`。

**前端要做的页面：**

* 一个新 HTML，例如 `hours_high_stress.html`：

  * 上图：箱线图 / 条图显示 high vs non-high 的工时分布（可以用分组柱 + 均值线代替，ECharts 好做）。
  * 下图：各工时档的高压比例柱状图。

#### B2. “学科 / 研究领域 × 高压”【未做】

目的：
从专业角度看高压差异，看看是否某些 broad field 更高压。

**Python 端：**

* 在 metadata 里定位“学科/领域”变量（例如包含 field / subject / discipline 的列）。
* 根据原问卷把具体专业归到几个大类（STEM、Social Sciences、Humanities、Life sciences 等）。
* 计算每个大类的：

  * 总样本数、high_stress_group=1 的 count / percent。
* 导出 `viz_field_high_stress.csv`。

**前端：**

* 一个 `field_high_stress.html`：

  * 条形图：各学科大类的高压比例（带样本量 tooltip）。
  * 可以加 degree 过滤（博士/硕士）。

#### B3. “性别 × 高压 / 其他身份变量”【未做】

目的：
补上性别 / minoritized status / caregiving responsibility 等公平性维度。

**Python 端：**

* 找到 gender / sex 相关变量（注意是否允许分析：“prefer not to say”等）。
* 按数据质量决定分组：例如 Male / Female / Other / Prefer not to say。
* 正常算各组的高压比例。
* 如果有“是否为第一代大学生 / 是否有照护责任 / 是否是少数族裔”等变量，也可以用同样方式做 1～2 个补充表。

**前端：**

* `gender_high_stress.html`（或 broader 的 `demographics_high_stress.html`）：

  * 多个条形图 / 分面图：性别 / 少数族裔 / 照护责任 × 高压比例。

---

### C 线：总览 & 故事化页面

这一块目前还没有真正实现，但如果你下一步想把结果写成文章 / 报告，它反而会非常重要。

#### C1. Risk ladder（风险阶梯 / 风险对比）【未做】

目的：
把“最重要的几个风险因子”放到一页上，直观展示：

> 某类人群的高压概率，比总体高/低了多少？

**Python 端：**

* 把若干关键分组的高压比例整理成一张宽表，例如：

  * debt: 有预期负债 vs 无负债 vs 不确定
  * satisfaction: 低满意 vs 中 vs 高
  * support: 低支持 vs 高支持（可以用我们已有的构造）
  * mental_help: 求助 vs 未求助
  * bullying / harassment: 有经历 vs 无
  * region: Europe / Asia / …

* 计算：

  * 每组的 high_stress_percent
  * “高于全样本的百分点差”（risk uplift）。

* 导出 `viz_risk_ladder.csv`。

**前端：**

* `risk_ladder_high_stress.html`：

  * 纵轴：不同风险因子组合（可以“分类 + 级别”拼成标签）。
  * 横轴：high_stress_percent 或 uplift（相对总体差值）。
  * 按从高到低排序，做一个“阶梯条形图”。

#### C2. 简易 Profile Explorer（条件筛选器）【未做】

目的：
做一个“玩具版决策树”：用户勾选几个条件，右边显示“按这些条件筛选后的高压比例”。

**前端为主（Python 只需提供足够细的明细表）：**

* Python：

  * 导出一个中等规模的明细表，只包含：`degree, region_continent, debt_cat, support_level, high_stress_group` 等几个关键变量，供前端 filter 使用。
* JS：

  * 左侧几个下拉（Degree, Region, Debt, Support level）。
  * 右边显示：筛选后的 n 和 high_stress_percent。
  * 这页可以不放复杂图，只放几个数字卡片 + 小条形图，压力不大。

---

### D 线：代码重构 & 论文输出（如果你需要）

这部分更偏“工程 & 写作”，不是必须，但是长远来看很有用。

1. **JS 工具化（utils.js）**【未做，但随时可做】

   * 把重复用的：

     * CSV 加载封装、
     * 百分比/计数切换、
     * 样本量 slider 控件、
     * 相同风格的 tooltip 和 label，
   * 抽到一个 `viz_utils.js`，避免每个 HTML 重复写。

2. **论文/报告用表格导出**【看你论文进度】

   * 例如：

     * 表 1：样本特征（degree、region、gender、field 等）。
     * 表 2：高压 vs 非高压在各项满意度/支持/事件上的均值/比例对比。
     * 表 3：回归结果（若你打算做 logit / OLS）。
   * 这些更偏统计汇总，不一定需要前端页面。

---

## 2. 接下来建议的执行顺序（给你一个“路线图”）

如果按“对论文 & 讲故事的价值”优先级，我会建议下面这个顺序逐步做：

1. **B1：工时解释页 – hours_high_stress（Python + 前端）**
   → 让读者直观看到“高压”概念与工时的关系。

2. **B2：学科 × 高压（field_high_stress）**

3. **B3：性别 / 身份变量 × 高压（gender / demographics）**

4. **C1：Risk ladder 总览页**
   → 把所有重要因子拼成一个“风险阶梯”。

5. （如果你还有精力）**C2：Profile Explorer 小工具**

6. 最后再看情况决定是否做 **D 线：utils.js 重构 + 论文用表格导出**。

---

如果你同意这个路线，**下一步我建议从 B1 开始**：
我们先在 Python 里写一个小脚本，专门为“每周工时 × 高压组”导出可视化用 CSV。你不用操心想太多结构，我直接按你现有的代码组织（/workspace/code + /workspace/output/08_viz_data）来写，你在本地跑完再把结果反馈给我，我们就能继续往下接前端页面。
